

# This file was *autogenerated* from the file lattice_data.sage
from sage.all_cmdline import *   # import sage library

_sage_const_927943022418138721022360056414021691267449268561 = Integer(927943022418138721022360056414021691267449268561); _sage_const_1812388715660427103868260568787565913302892544 = Integer(1812388715660427103868260568787565913302892544); _sage_const_20 = Integer(20); _sage_const_1 = Integer(1); _sage_const_277783933949656438718423027901495635725403621533 = Integer(277783933949656438718423027901495635725403621533); _sage_const_894079209621918382896444979919421990724683959827 = Integer(894079209621918382896444979919421990724683959827); _sage_const_773269357572651091992290242866879615569189109883 = Integer(773269357572651091992290242866879615569189109883); _sage_const_152407352376871887122856325226964593496633716228 = Integer(152407352376871887122856325226964593496633716228); _sage_const_41176324957025051597191450440715461939347676454 = Integer(41176324957025051597191450440715461939347676454); _sage_const_425927073462482159743877463467738877090168473361 = Integer(425927073462482159743877463467738877090168473361); _sage_const_864955584657518696553481463062061888762066160870 = Integer(864955584657518696553481463062061888762066160870); _sage_const_594594160605145604775607035634898503748718462579 = Integer(594594160605145604775607035634898503748718462579); _sage_const_368678314364039824174987201859107877615320023470 = Integer(368678314364039824174987201859107877615320023470); _sage_const_443380087862708692534659335350855845062722461395 = Integer(443380087862708692534659335350855845062722461395); _sage_const_566264934454509762662932296538497302690024211420 = Integer(566264934454509762662932296538497302690024211420); _sage_const_823218672611698060767062571776697770064235325580 = Integer(823218672611698060767062571776697770064235325580); _sage_const_248674869462688485079931731975826008122656251250 = Integer(248674869462688485079931731975826008122656251250); _sage_const_122637752256568971415596846431273991481942018998 = Integer(122637752256568971415596846431273991481942018998); _sage_const_616666128489029847430196400197774605616212174469 = Integer(616666128489029847430196400197774605616212174469); _sage_const_54044550198199312084822724963984667376969719765 = Integer(54044550198199312084822724963984667376969719765); _sage_const_103422304639462792739688630564470222870878573517 = Integer(103422304639462792739688630564470222870878573517); _sage_const_139290384840617279460879479452209989308499986076 = Integer(139290384840617279460879479452209989308499986076); _sage_const_63685490500432362272038784685816539020064674309 = Integer(63685490500432362272038784685816539020064674309); _sage_const_0 = Integer(0); _sage_const_57663172811146863049092243891307528245821436032 = Integer(57663172811146863049092243891307528245821436032); _sage_const_102279934888486170292441793668786484206881181316 = Integer(102279934888486170292441793668786484206881181316); _sage_const_271004350566980917812682860164649995428692909862 = Integer(271004350566980917812682860164649995428692909862); _sage_const_495766517322880855298257105909436769959435185881 = Integer(495766517322880855298257105909436769959435185881); _sage_const_695434582999116062974351399094636771621538054240 = Integer(695434582999116062974351399094636771621538054240); _sage_const_334171103448705042894339177009027232322885382465 = Integer(334171103448705042894339177009027232322885382465); _sage_const_557539383016177937144430573975245444599307422632 = Integer(557539383016177937144430573975245444599307422632); _sage_const_107973678013759434150429877704900529065541886484 = Integer(107973678013759434150429877704900529065541886484); _sage_const_366259143477391566607711113852103537876924746615 = Integer(366259143477391566607711113852103537876924746615); _sage_const_261555230154878635182637212150228625412219605093 = Integer(261555230154878635182637212150228625412219605093); _sage_const_427451235527587542414452551176518379691674028707 = Integer(427451235527587542414452551176518379691674028707); _sage_const_714786306787891015374254304815541201275162955646 = Integer(714786306787891015374254304815541201275162955646); _sage_const_792065329476399772345748585415941178439265668586 = Integer(792065329476399772345748585415941178439265668586); _sage_const_40856219962130793098492091035953430154317972789 = Integer(40856219962130793098492091035953430154317972789); _sage_const_222760503242835272004594119371670158909458414562 = Integer(222760503242835272004594119371670158909458414562); _sage_const_768973915924972586430904780607516879904558122954 = Integer(768973915924972586430904780607516879904558122954); _sage_const_698519921072445630276710886217079621942159597856 = Integer(698519921072445630276710886217079621942159597856); _sage_const_370618841864549421237692442366179290517277811130 = Integer(370618841864549421237692442366179290517277811130); _sage_const_815934368320717127623205755193191392065489990312 = Integer(815934368320717127623205755193191392065489990312); _sage_const_29178288144072822714405951139088911410894175107 = Integer(29178288144072822714405951139088911410894175107); _sage_const_39460513883381333836474199963783122914858080344 = Integer(39460513883381333836474199963783122914858080344); _sage_const_37592873801746904410398690060748424303362045737704985040182603741872729091191 = Integer(37592873801746904410398690060748424303362045737704985040182603741872729091191)# Sage script for lattice attack
# Generated from Python preparation

modulo = _sage_const_927943022418138721022360056414021691267449268561 
trick = _sage_const_1812388715660427103868260568787565913302892544 
nn = _sage_const_20 

AA = [-_sage_const_1 , _sage_const_277783933949656438718423027901495635725403621533 , _sage_const_894079209621918382896444979919421990724683959827 , _sage_const_773269357572651091992290242866879615569189109883 , _sage_const_152407352376871887122856325226964593496633716228 , _sage_const_41176324957025051597191450440715461939347676454 , _sage_const_425927073462482159743877463467738877090168473361 , _sage_const_864955584657518696553481463062061888762066160870 , _sage_const_594594160605145604775607035634898503748718462579 , _sage_const_368678314364039824174987201859107877615320023470 , _sage_const_443380087862708692534659335350855845062722461395 , _sage_const_566264934454509762662932296538497302690024211420 , _sage_const_823218672611698060767062571776697770064235325580 , _sage_const_248674869462688485079931731975826008122656251250 , _sage_const_122637752256568971415596846431273991481942018998 , _sage_const_616666128489029847430196400197774605616212174469 , _sage_const_54044550198199312084822724963984667376969719765 , _sage_const_103422304639462792739688630564470222870878573517 , _sage_const_139290384840617279460879479452209989308499986076 , _sage_const_63685490500432362272038784685816539020064674309 ]
BB = [_sage_const_0 , _sage_const_57663172811146863049092243891307528245821436032 , _sage_const_102279934888486170292441793668786484206881181316 , _sage_const_271004350566980917812682860164649995428692909862 , _sage_const_495766517322880855298257105909436769959435185881 , _sage_const_695434582999116062974351399094636771621538054240 , _sage_const_334171103448705042894339177009027232322885382465 , _sage_const_557539383016177937144430573975245444599307422632 , _sage_const_107973678013759434150429877704900529065541886484 , _sage_const_366259143477391566607711113852103537876924746615 , _sage_const_261555230154878635182637212150228625412219605093 , _sage_const_427451235527587542414452551176518379691674028707 , _sage_const_714786306787891015374254304815541201275162955646 , _sage_const_792065329476399772345748585415941178439265668586 , _sage_const_40856219962130793098492091035953430154317972789 , _sage_const_222760503242835272004594119371670158909458414562 , _sage_const_768973915924972586430904780607516879904558122954 , _sage_const_698519921072445630276710886217079621942159597856 , _sage_const_370618841864549421237692442366179290517277811130 , _sage_const_815934368320717127623205755193191392065489990312 ]

first_r = _sage_const_29178288144072822714405951139088911410894175107 
first_s = _sage_const_39460513883381333836474199963783122914858080344 
first_m = _sage_const_37592873801746904410398690060748424303362045737704985040182603741872729091191 


# Embedding Technique (CVP->SVP)
if trick != -_sage_const_1 :
    lattice = Matrix(ZZ, nn + _sage_const_1 )
else:
    lattice = Matrix(ZZ, nn)

# Fill lattice
for ii in range(nn):
    lattice[ii, ii] = modulo
    lattice[_sage_const_0 , ii] = AA[ii]

# Add trick
if trick != -_sage_const_1 :
    print(f"Adding trick: {trick}")
    BB.append(trick)
    lattice[nn] = vector(BB)
else:
    print("Not adding any trick")

print("Using LLL reduction")
lattice = lattice.LLL()

# Check if solution is found
if trick == -_sage_const_1  or Mod(lattice[_sage_const_0 ,-_sage_const_1 ], modulo) == trick or Mod(lattice[_sage_const_0 ,-_sage_const_1 ], modulo) == Mod(-trick, modulo):
    print("Solution found in lattice!")
    
    # did we found trick or -trick?
    if trick != -_sage_const_1 :
        # trick
        if Mod(lattice[_sage_const_0 ,-_sage_const_1 ], modulo) == trick:
            solution = -_sage_const_1  * lattice[_sage_const_0 ] - vector(BB)
        # -trick
        else:
            print("We found a -trick instead of a trick")
            solution = lattice[_sage_const_0 ] + vector(BB)
    else:
        solution = -_sage_const_1  * lattice[_sage_const_0 ] - vector(BB)

    # get rid of (..., trick) if we used the trick
    if trick != -_sage_const_1 :
        vec = list(solution)
        vec.pop()
        solution = vector(vec)

    # recover private key
    nonce = solution[_sage_const_0 ]
    key = Mod((first_s * nonce - first_m) * inverse_mod(first_r, modulo), modulo)
    
    print(f"Recovered private key candidate: {key}")
    print(f"KEY_RESULT = {key}")
else:
    print("No solution found in lattice")
    print("KEY_RESULT = 0")

